# BE-JV-007 Programação Web II

## Aulas, Carga Horária e Duração
|          |2x na semana|3x na semana|
|----------|:----------:|:-----------:|
|Aulas     |8           |9            |
|Carga     |24h         |27h          |
|Duração   |4 semanas  |3 semanas    |

## Objetivos de Aprendizagem

Este módulo visa dominar o desenvolvimento web Java com Spring voltado para projetos de API REST no nível 2 de maturidade, segundo o modelo de Richardson. Começando de uma revisão sobre HTTP, capacita ao desenvolvimento de projetos com Spring, mas também relacionando à especificação JEE, de forma que os alunos possam mirar para Quarkus e outros. Por fim, também inclui tópicos como acesso a dados e segurança de aplicações com OAuth2 e JWT. 

Esse módulo tem como pré-requisitos o conhecimento básico de redes, sistemas distribuídos e bancos de dados. 

## Habilidades

As habilidades são definidas em Área de Conhecimento/Categoria/Sub-categoria, de acordo com o Skill Map e considerando o último nível como opcional.

- Redes/Protocolos/HTTP
- Protocolos Web/HTTP
- Protocolos Web/REST
- Spring/Frameworks
- Spring/Spring Boot
- Spring/Spring Core
- Spring/Spring Web MVC
- Spring/Spring Data
- Spring/Spring Security
- Segurança/Autenticação
- Segurança/Autorização
- Segurança/JWT
- Segurança/SSO/OAuth

## Avaliação por Rubricas

As habilidades e competências a serem desenvolvidas no módulo, além das atitudinais padrão, são:

- Compreender o protocolo HTTP (modelo requisição/resposta, formato da mensagem, verbos e códigos de status)
- Compreender, criar e manter uma API REST no nível 2 de maturidade do modelo de Richardson
- Compreender, criar e manter projetos usando gerenciadores de dependências e bibliotecas com Maven
- Compreender, criar e manter projetos compatíveis com JEE
- Compreender, criar e manter projetos com Spring Boot
- Compreender, criar e manter projetos com Spring Data
- Compreender, criar e manter projetos com Spring Security
- Compreender e aplicar conceitos de aplicações seguras
- Compreender, criar e manter projetos com JWT
- Compreender, criar e manter projetos com OAuth2

## Planejamento Geral

<table>
    <tr>
        <th>Objetivos</th>
        <th>Conteúdos</th>
        <th>Bibliografia</th>
        <th>Metodologia</th>
        <th>Avaliação</th>
        <th>Observações</th>
    </tr>
    <tr>
        <td><!--Objetivos-->
            Dominar o funcionamento do protocolo HTTP para aplicações webs, quanto ao modelo requisição/resposta, formato das mensagens, verbos (get, post, put, patch e delete) e códigos de estado.<br/><br/>
            Dominar o gerenciamento de dependências e bibliotecas com o Maven.<br/><br/>
            Dominar o design de API REST segundo o nível 2 de maturidade de Richardson.<br/><br/>
            Compreender as principais definições da especificação JEE<br/><br/>
            Criar e manter projetos web com Spring Boot.<br/><br/>
            Criar e manter projetos Spring com acesso a dados, usando Spring Data.<br/><br/>
            Criar e manter projetos Spring com controle de autenticação e autorização, usando Spring Security.<br/><br/>
            Compreender o funcionamento de tokens JWT e o protocolo OAuth2.<br/><br/>
        </td>
        <td><!--Conteúdos-->
            O protocolo HTTP.<br/><br/>
            API REST.<br/><br/>
            Modelo de maturidade de Richardson.<br/><br/>
            Design de API's.<br/><br/>
            Bibliotecas de código.<br/><br/>
            Gerenciamento de dependências e build com Maven.<br/><br/>
            Biblioteca Jackson para conversão JSON/Java.<br/><br/>
            Biblioteca Lombok para simplificar o código Java.<br/><br/>
            A especificação JEE e os frameworks.<br/><br/>
            O framework mais popular: Spring.<br/><br/>
            O projeto Spring Boot e o gerenciamento opinativo de configurações.<br/><br/>
            Projeto web com Spring Boot.<br/><br/>
            Controladores REST.<br/><br/>
            Aplicações em camadas.<br/><br/>
            Gerenciamento de Spring Beans.<br/><br/>
            Validação de beans.<br/><br/>
            Gerenciamento de erros com Exception Handler.<br/><br/>
            Gerenciamento de cache.<br/><br/>
            Leitura e escrita de dados com Spring Data.<br/><br/>
            Segurança de aplicações usando Spring Security.<br/><br/>
            Autenticação em memória.<br/><br/>
            Autenticação em banco de dados.<br/><br/>
            Autenticação com SSO usando OAuth2.<br/><br/>
            Controle de autorização.<br/><br/>
            Tokens JWT para tráfego das informações de autenticação e autorização.<br/><br/>
        </td>
        <td><!--Bibliografia-->
            - Java Efetivo. Joshua Bloch. 3ª edição. 2018. Alta Books.<br/>
            Título original: Effective Java. Joshua Bloch. 3rd edition. 2018. Addison-Wesley.<br/>
            - Spring em Ação. Craig Walls. 5ª edição. 2018. Novatec.<br/>
            Título original: Spring in Action. Craig Walls. 5th edition. 2018. Manning Publications.<br/>
            - RESTful Web Services. Leonard Richardson, Sam Ruby. 1ª edição. 2007. O'Reilly Media.<br/>
            - Spring Boot em Ação. Craig Walls. 1ª edição. 2015. Novatec.<br/>
            Título original: Spring Boot in Action. Craig Walls. 1st edition. 2015. Manning Publications.<br/>
            - HTTP: Guia Definitivo. David Gourley, Brian Totty. 1ª edição. 2002. O'Reilly Media.<br/>
            Título original: HTTP: The Definitive Guide. David Gourley, Brian Totty. 1st edition. 2002. O'Reilly Media.<br/>
            - Arquitetura Limpa. Robert C. Martin. 1ª edição. 2017. Alta Books.<br/>
            Título original: Clean Architecture. Robert C. Martin. 1st edition. 2017. Addison-Wesley.<br/>
            - Jackson in Action. Tatu Saloranta. 1ª edição. 2017. Manning Publications.<br/>
            - Design de APIs com Swagger e OpenAPI. Josh Ponelat, Lukas Rosenstock. 1ª edição. 2022. Manning Publications.<br/>
            Título original: Designing APIs with Swagger and OpenAPI. Josh Ponelat, Lukas Rosenstock. 1st edition. 2022. Manning Publications.<br/>
            - Pro Spring 6. Iuliana Cosmina, Rob Harrop, Chris Schaefer. 6ª edição. 2022. Apress.<br/>
            - Spring Data: Modern Data Access for Enterprise Java. Mark Pollack, Oliver Gierke, Thomas Risberg. 2ª edição. 2019. Apress.<br/>
            - OAuth 2.0 Simplificado. Aaron Parecki. 1ª edição. 2017. OAuth.net.<br/>
            Título original: OAuth 2.0 Simplified. Aaron Parecki. 1st edition. 2017. OAuth.net.<br/>
            - Construindo Microsserviços. Sam Newman. 2ª edição. 2021. O'Reilly Media.<br/>
            Título original: Building Microservices. Sam Newman. 2nd edition. 2021. O'Reilly Media.<br/>
            - JWT: Guia Prático. Auth0. 1ª edição. 2019. Auth0.<br/>
            Título original: JWT Handbook. Auth0. 1st edition. 2019. Auth0.<br/>
            - Spring Security em Ação. Laurentiu Spilca. 1ª edição. 2020. Manning Publications.<br/>
            Título original: Spring Security in Action. Laurentiu Spilca. 1st edition. 2020. Manning Publications.<br/>
            - Programação Jakarta EE 9. Mick Knutson. 1ª edição. 2020. Apress.<br/>
            Título original: Programming Jakarta EE 9. Mick Knutson. 1st edition. 2020. Apress.<br/>
            - Java Moderno em Ação. Raoul-Gabriel Urma, Mario Fusco, Alan Mycroft. 2ª edição. 2020. Editora NovaTec.<br/>
            Título original: Modern Java in Action. Raoul-Gabriel Urma, Mario Fusco, Alan Mycroft. 2nd edition. 2019. Manning Publications.<br/>
        </td>
        <td><!--Metodologia-->
            Realização de exemplos em sala em conjunto com os alunos.<br/><br/>
            Dinâmicas e desafios.<br/><br/>
            Listas de exercícios individuais.<br/><br/>
            Estudos de caso (mini-projeto).<br/><br/>
            Pesquisa individual na documentação.<br/><br/>
            Competições saudáveis em grupo para buscar as melhores práticas.<br/><br/>
        </td>
        <td><!--Avaliação-->
            Presença e participação nas aulas.<br/><br/>
            Colaboração com os colegas nas atividades em grupo e nas interações nas aulas.<br/><br/>
            Resolução das listas de exercícios padrão.<br/><br/>
            Resolução dos cases e desafios propostos em aula.<br/><br/>
            Projeto individual ou em grupo definido pelo instrutor do módulo.<br/><br/>
        </td>
        <td><!--Observações-->
            Este módulo deve ser ministrado com dinamismo e agilidade, conforme o perfil da turma e nível de experiência pregressa em programação web e linguagem Java. Fique atento para ajustar os conteúdos e as aulas que tragam maior percepção de aprendizado e aproveitamento do tema.<br/><br/>
        </td>
    </tr>
</table>

## Plano de Aula

<table>
<tr>
<th>Aula</th>
<th>Problema Gerador</th>
<th>Conceitos</th>
<th>Metodologia</th>
</tr>
<tr>
<td>Aula 1</td>
<td><!--Problema Gerador-->
Como funcionam as aplicações web?
</td>
<td><!--Conceitos-->
Programação distribuída<br/><br/> 
Protocolo HTTP: estrutura da requisição e resposta, verbos HTTP, códigos de status<br/><br/> 
API REST: princípios e arquitetura, modelo de maturidade de Richardson<br/><br/> 
</td>
<td><!--Metodologia-->
Estudo de Caso: <br />
Navegar numa API pública (ex.: https://dummyjson.com/docs)<br /><br />
Expositiva:<br />
- Explicar o modelo requisição/resposta do HTTP.<br />
- Introduzir os principais verbos HTTP (GET, POST, PUT, DELETE) e códigos de status.<br />
- Apresentar os princípios RESTful e o modelo de maturidade de Richardson até o nível 2.<br />
- Apresentar a documentação de uma API; <br />
- Realizar chamadas à API usando diversos clientes: navegador, js no console, cURL, postman, etc.; <br /><br />
Pesquisa individual:<br />
- Como Java implementa um cliente nativo usando aplicação console e sem bibliotecas de terceiros?<br /><br />
Desafio:<br />
- Implementar um cliente Java nativo fazendo chamada a uma API pública (ex.: https://viacep.com.br/)<br /><br />
</td>
</tr>
<tr>
<td>Aula 2</td>
<td><!--Problema Gerador-->
Como gerenciar dependências e simplificar a manipulação de dados em Java?
</td>
<td><!--Conceitos-->
Gerenciamento de dependências e build com Maven<br/><br/>
Biblioteca Jackson para conversão entre JSON e Java<br/><br/>
Biblioteca Lombok para simplificar o código Java<br/><br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Criar uma aplicação Java que consome dados de uma API pública (ex.: JSONPlaceholder), usando Maven para gerenciar as dependências e Jackson para converter o JSON em objetos Java.<br /><br />
Expositiva:<br />
- Apresentar o Maven: estrutura do projeto, POM.xml, configuração de dependências e plugins.<br />
- Explicar o uso da biblioteca Jackson para conversão JSON-Java.<br />
- Introduzir a biblioteca Lombok para simplificação do código (anotações como @Data, @Builder e @AllArgsConstructor).<br /><br />
Pesquisa individual:<br />
- Quais são as principais diferenças entre o Maven e outros gerenciadores, como Gradle?<br />
- Como funciona o Jackson internamente ao mapear JSON para Java?<br /><br />
Desafio:<br />
- Configurar um projeto Maven que consome dados de uma API pública, converte o JSON em objetos Java usando Jackson e usa Lombok para reduzir o boilerplate do modelo de dados.<br />
- Testar com diferentes endpoints da API para validar a conversão.<br /><br />
</td>
</tr>
<tr>
<td>Aula 3</td>
<td><!--Problema Gerador-->
Como criar aplicações web robustas usando o Spring Boot e o padrão MVC?
</td>
<td><!--Conceitos-->
Introdução ao framework Spring<br/><br/>
Projeto Spring Boot: configuração inicial e estrutura do projeto<br/><br/>
Spring Web MVC: controladores, rotas e respostas<br/><br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Criar uma aplicação Spring Boot simples que exibe uma lista de produtos via um endpoint REST e segue o padrão MVC.<br /><br />
Expositiva:<br />
- Explicar o Spring Framework e a proposta do Spring Boot.<br/>
- Demonstrar a configuração inicial do projeto usando Spring Initializr.<br/>
- Apresentar o padrão MVC no contexto do Spring (Controlador, Serviço e Modelo).<br/>
- Explicar a anotação @RestController e os métodos HTTP associados.<br /><br />
Pesquisa individual:<br />
- Como o Spring Boot facilita a configuração e o gerenciamento de dependências?<br/>
- Qual a diferença entre @Controller e @RestController no Spring?<br /><br />
Desafio:<br />
- Criar um endpoint REST usando Spring Boot que retorna uma lista de produtos fictícios em JSON.<br/>
- Organizar o projeto seguindo o padrão MVC, separando Controlador, Serviço e Modelo.<br /><br />
</td>
</tr>

<tr>
<td>Aula 4</td>
<td><!--Problema Gerador-->
O que é a especificação JEE e como ela se relaciona com frameworks modernos como o Spring e o Quarkus?
</td>
<td><!--Conceitos-->
Introdução à especificação JEE (Java EE)<br/><br/>
JAX-RS: API para criação de serviços REST<br/><br/>
Diferenças entre a especificação JEE e frameworks modernos (Spring e Quarkus)<br/><br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Criar uma API REST simples usando JAX-RS (JEE) para expor endpoints básicos (GET e POST).<br />
- Comparar a implementação com uma API equivalente criada com Spring Boot.<br /><br />
Expositiva:<br />
- Apresentar a especificação JEE e o papel do JAX-RS no desenvolvimento de APIs REST.<br/>
- Demonstrar as principais anotações e recursos do JAX-RS (ex.: @Path, @GET, @POST, @Produces).<br/>
- Explicar as diferenças entre a especificação JEE e a abordagem opinativa do Spring Boot.<br/>
- Introduzir o Quarkus como uma alternativa moderna para criar APIs baseadas em JEE, com foco em eficiência e aplicações nativas em nuvem.<br /><br />
Pesquisa individual:<br />
- Como o JAX-RS se diferencia do Spring Web MVC na criação de APIs REST?<br/>
- Quais são os principais recursos do Quarkus que otimizam o desenvolvimento de APIs?<br /><br />
Desafio:<br />
- Criar uma API REST usando JAX-RS que permita listar e adicionar registros fictícios.<br/>
- Refatorar a API para o Spring Boot e identificar as diferenças na abordagem.<br/>
- Explorar como a mesma API pode ser implementada usando Quarkus.<br />
</td>
</tr>

<tr>
<td>Aula 5</td>
<td><!--Problema Gerador-->
Como gerenciar o acesso a dados em uma aplicação web utilizando Spring Data JPA e Hibernate?
</td>
<td><!--Conceitos-->
Introdução ao Hibernate como implementação JPA<br/><br/>
Configuração de datasources no Spring Boot<br/><br/>
Mapeamento de entidades e relacionamentos com JPA<br/><br/>
Uso do JpaRepository para criação de query methods<br/><br/>
Consultas com JPQL e queries nativas<br/><br/>
Paginação e ordenação de resultados<br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Criar uma aplicação Spring Boot conectada a um banco de dados relacional para gerenciar um cadastro de clientes, utilizando Spring Data JPA e Hibernate.<br />
- Implementar operações básicas (CRUD) e consultas avançadas, explorando paginação e ordenação.<br /><br />
Expositiva:<br />
- Apresentar o Hibernate como uma implementação da especificação JPA.<br/>
- Demonstrar como configurar datasources no `application.properties` ou `application.yml`.<br/>
- Explicar o mapeamento de entidades e relacionamentos (ex.: @Entity, @OneToMany, @ManyToOne).<br/>
- Mostrar como usar o JpaRepository para query methods, JPQL e queries nativas.<br/>
- Introduzir as funcionalidades de paginação e ordenação com Spring Data JPA.<br /><br />
Pesquisa individual:<br />
- Quais são os benefícios do uso do Hibernate sobre consultas SQL diretas?<br/>
- Como a anotação @Query pode ser usada para personalizar consultas?<br /><br />
Desafio:<br />
- Configurar um datasource e criar uma entidade Cliente mapeada para uma tabela no banco.<br/>
- Implementar um JpaRepository com query methods para buscar clientes por diferentes critérios.<br/>
- Criar uma consulta JPQL que retorne clientes em ordem decrescente de data de cadastro.<br/>
- Implementar paginação para listar clientes em páginas de 5 registros.<br />
</td>
</tr>

<tr>
<td>Aula 6</td>
<td><!--Problema Gerador-->
Como aumentar a maturidade de um projeto web com validações, tratamento de erros e otimizações?
</td>
<td><!--Conceitos-->
Validação de dados com Bean Validation (javax.validation)<br/><br/>
Gerenciamento de erros com Exception Handler (@ControllerAdvice e @ExceptionHandler)<br/><br/>
Gerenciamento de componentes (Spring Beans e contexto de aplicação)<br/><br/>
Cache de dados com Spring Cache e anotações como @Cacheable e @CacheEvict<br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Criar uma aplicação Spring Boot para gerenciamento de produtos que valida dados de entrada, trata erros comuns e implementa cache para otimizar consultas de produtos mais acessados.<br /><br />
Expositiva:<br />
- Explicar o uso do Bean Validation para validação automática de dados com anotações (@NotNull, @Size, @Email, etc.).<br/>
- Apresentar o gerenciamento de erros com @ControllerAdvice e @ExceptionHandler, incluindo a criação de mensagens de erro padronizadas.<br/>
- Demonstrar o ciclo de vida dos Spring Beans e o gerenciamento de dependências no contexto do Spring.<br/>
- Introduzir o uso do Spring Cache, incluindo a configuração de caches em memória e o uso de anotações (@Cacheable e @CacheEvict) para melhorar a performance.<br /><br />
Pesquisa individual:<br />
- Quais são os benefícios do uso de Bean Validation em projetos modernos?<br/>
- Como o Spring Cache pode ser configurado com diferentes implementações (ex.: EhCache, Redis)?<br /><br />
Desafio:<br />
- Adicionar validação de dados no cadastro de produtos (ex.: nome não nulo, preço positivo).<br/>
- Criar um controlador com tratamento de erros personalizados para entradas inválidas.<br/>
- Implementar um cache para a listagem de produtos mais acessados, com limpeza automática a cada nova atualização.<br/>
- Configurar um bean personalizado para fornecer uma mensagem de boas-vindas com base no horário do dia.<br />
</td>
</tr>

<tr>
<td>Aula 7</td>
<td><!--Problema Gerador-->
Como implementar segurança em aplicações web seguindo boas práticas e utilizando o Spring Security?
</td>
<td><!--Conceitos-->
Segurança de aplicações web: OWASP e práticas *secure by design*<br/><br/>
Introdução ao Spring Security<br/><br/>
Gerenciamento de usuários em memória e no banco de dados<br/><br/>
Proteção de senhas com *password encoders*<br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Criar uma aplicação Spring Boot com autenticação baseada em usuários armazenados em memória.<br />
- Evoluir a aplicação para armazenar os usuários no banco de dados, protegendo as senhas com *password encoders*.<br /><br />
Expositiva:<br />
- Introduzir os principais conceitos de segurança de aplicações web, com foco em OWASP Top 10 (ex.: SQL Injection, XSS, CSRF).<br/>
- Apresentar o conceito de *secure by design* e a importância de considerar a segurança desde o início do desenvolvimento.<br/>
- Explicar o funcionamento básico do Spring Security e sua configuração inicial.<br/>
- Demonstrar o gerenciamento de usuários em memória com *InMemoryUserDetailsManager*.<br/>
- Apresentar como configurar o gerenciamento de usuários no banco de dados e proteger senhas usando *BCryptPasswordEncoder* e outros encoders.<br /><br />
Pesquisa individual:<br />
- O que é o OWASP Top 10 e como ele ajuda a identificar vulnerabilidades em aplicações web?<br/>
- Quais são as vantagens do uso de *BCrypt* para proteger senhas em comparação com algoritmos mais antigos?<br /><br />
Desafio:<br />
- Configurar autenticação em memória usando Spring Security para permitir acesso a endpoints protegidos.<br/>
- Migrar a autenticação para o banco de dados, criando uma tabela de usuários com colunas de *username* e *password*.<br/>
- Proteger as senhas usando *BCryptPasswordEncoder*.<br/>
- Criar um endpoint protegido e testar o acesso usando diferentes usuários e senhas.<br />
</td>
</tr>

<tr>
<td>Aula 8</td>
<td><!--Problema Gerador-->
Como evoluir aplicações web para ambientes integrados, utilizando JWT e SSO via OAuth2?
</td>
<td><!--Conceitos-->
Cenários de integração com múltiplas aplicações<br/><br/>
Autenticação com JWT (JSON Web Token)<br/><br/>
Introdução ao SSO (Single Sign-On) e protocolo OAuth2<br/><br/>
Configuração do Spring Security para JWT e OAuth2<br/>
</td>
<td><!--Metodologia-->
Estudo de Caso:<br />
- Evoluir a aplicação existente para um cenário integrado, utilizando tokens JWT para autenticação e configurando o Spring Security para integração com um provedor de SSO usando OAuth2.<br /><br />
Expositiva:<br />
- Explicar cenários complexos de múltiplas aplicações e a necessidade de soluções centralizadas de autenticação.<br/>
- Apresentar o funcionamento de tokens JWT: estrutura, geração, assinatura e verificação.<br/>
- Introduzir o conceito de SSO e o protocolo OAuth2, destacando o fluxo de autorização (Authorization Code Flow).<br/>
- Demonstrar como configurar o Spring Security para autenticação JWT e OAuth2.<br/><br />
Pesquisa individual:<br />
- O que são os fluxos de autorização do OAuth2 e quando utilizá-los?<br/>
- Quais são as principais diferenças entre JWT e outros métodos de autenticação, como sessões?<br/><br />
Desafio:<br />
- Configurar autenticação JWT na aplicação Spring Boot para proteger endpoints com base em tokens.<br/>
- Integrar a aplicação com um provedor de SSO fictício (ex.: Keycloak, Okta) utilizando OAuth2.<br/>
- Testar o fluxo completo de geração, troca e verificação de tokens, garantindo que apenas usuários autenticados tenham acesso aos recursos protegidos.<br/>
</td>
</tr>


<tr>
<td>Aula 9</td>
<td colspan="3">Aula dedicada à devolutiva da avaliação por rubrica / auto-avaliação</td>
</tr>
</table>